<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arduino 3D Programmer</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- React -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- Babel pour JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: #0f172a;
            color: #f1f5f9;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
        }
        
        .glass-effect {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .card-hover {
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .card-hover:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.2);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #2563eb, #1e40af);
            transform: translateY(-1px);
            box-shadow: 0 5px 15px rgba(37, 99, 235, 0.4);
        }
        
        .tab-active {
            background: rgba(59, 130, 246, 0.2);
            border: 1px solid rgba(59, 130, 246, 0.3);
            color: #60a5fa;
        }
        
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: .5;
            }
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #60a5fa, #a78bfa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* Three.js Canvas */
        #three-container {
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        .three-canvas {
            width: 100%;
            height: 400px;
            border-radius: 12px;
            overflow: hidden;
        }
        
        /* Terminal style */
        .terminal {
            background: #1a1a1a;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            border-radius: 8px;
        }
        
        .terminal-content {
            height: 300px;
            overflow-y: auto;
            padding: 16px;
        }
        
        .command {
            color: #60a5fa;
        }
        
        .response {
            color: #34d399;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(30, 41, 59, 0.5);
        }
        
        ::-webkit-scrollbar-thumb {
            background: #475569;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
    </style>
</head>
<body class="min-h-screen bg-gray-900">
    <div id="root"></div>

    <script type="text/babel">
        // Composants React
        const { useState, useEffect, useRef } = React;
        
        // Header Component
        function Header() {
            const [theme, setTheme] = useState('dark');
            
            return (
                <header className="glass-effect border-b border-gray-800 sticky top-0 z-50">
                    <div className="container mx-auto px-4 py-4">
                        <div className="flex items-center justify-between">
                            <div className="flex items-center space-x-3">
                                <div className="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                        <rect x="4" y="4" width="16" height="16" rx="2"></rect>
                                        <rect x="8" y="8" width="8" height="8" rx="1"></rect>
                                    </svg>
                                </div>
                                <div>
                                    <h1 className="text-xl font-bold gradient-text">Arduino 3D Programmer</h1>
                                    <p className="text-sm text-gray-400">Interface Web pour programmation Arduino</p>
                                </div>
                            </div>
                            <button className="btn-primary flex items-center space-x-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                    <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
                                    <polyline points="10 17 15 12 10 7"></polyline>
                                    <line x1="15" y1="12" x2="3" y2="12"></line>
                                </svg>
                                <span>Se connecter</span>
                            </button>
                        </div>
                    </div>
                </header>
            );
        }
        
        // Navigation Tabs
        function Navigation({ activeTab, setActiveTab }) {
            const tabs = [
                { id: 'dashboard', label: 'Dashboard', icon: 'LayoutDashboard' },
                { id: 'usb', label: 'USB', icon: 'Usb' },
                { id: 'wifi', label: 'WiFi', icon: 'Wifi' },
                { id: 'editor', label: 'Éditeur', icon: 'Code' },
                { id: 'visual', label: 'Visual 3D', icon: 'Box' },
                { id: 'monitor', label: 'Moniteur', icon: 'Terminal' }
            ];
            
            return (
                <div className="container mx-auto px-4 py-6">
                    <div className="flex flex-wrap gap-2">
                        {tabs.map(tab => (
                            <button
                                key={tab.id}
                                onClick={() => setActiveTab(tab.id)}
                                className={`flex items-center space-x-2 px-4 py-2 rounded-lg transition-all ${
                                    activeTab === tab.id 
                                    ? 'tab-active' 
                                    : 'glass-effect hover:bg-gray-800'
                                }`}
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                    {tab.icon === 'LayoutDashboard' && <rect width="7" height="9" x="3" y="3" rx="1"></rect>}
                                    {tab.icon === 'Usb' && <circle cx="10" cy="7" r="1"></circle>}
                                    {tab.icon === 'Wifi' && <path d="M12 20h.01"></path>}
                                    {tab.icon === 'Code' && <polyline points="16 18 22 12 16 6"></polyline>}
                                    {tab.icon === 'Box' && <path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"></path>}
                                    {tab.icon === 'Terminal' && <polyline points="4 17 10 11 4 5"></polyline>}
                                </svg>
                                <span>{tab.label}</span>
                            </button>
                        ))}
                    </div>
                </div>
            );
        }
        
        // Dashboard Tab
        function Dashboard() {
            const [stats, setStats] = useState({
                devices: 2,
                dataPoints: 1456,
                uploads: 12,
                connected: true
            });
            
            return (
                <div className="container mx-auto px-4 py-6">
                    <h2 className="text-2xl font-bold mb-6 gradient-text">Tableau de Bord</h2>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                        <div className="glass-effect p-6 rounded-xl card-hover">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-gray-400 text-sm">Appareils</p>
                                    <p className="text-2xl font-bold">{stats.devices}</p>
                                </div>
                                <div className="w-12 h-12 rounded-lg bg-blue-500/20 flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                        <circle cx="10" cy="7" r="1"></circle>
                                        <circle cx="4" cy="20" r="1"></circle>
                                        <path d="M4.7 19.3 19 5"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div className="glass-effect p-6 rounded-xl card-hover">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-gray-400 text-sm">Données</p>
                                    <p className="text-2xl font-bold">{stats.dataPoints}</p>
                                </div>
                                <div className="w-12 h-12 rounded-lg bg-green-500/20 flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                        <path d="m3 11 18-5v12L3 14v-3Z"></path>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div className="glass-effect p-6 rounded-xl card-hover">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-gray-400 text-sm">Uploads</p>
                                    <p className="text-2xl font-bold">{stats.uploads}</p>
                                </div>
                                <div className="w-12 h-12 rounded-lg bg-purple-500/20 flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="17 8 12 3 7 8"></polyline>
                                        <line x1="12" y1="3" x2="12" y2="15"></line>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        
                        <div className="glass-effect p-6 rounded-xl card-hover">
                            <div className="flex items-center justify-between">
                                <div>
                                    <p className="text-gray-400 text-sm">Statut</p>
                                    <p className="text-2xl font-bold">{stats.connected ? 'Connecté' : 'Déconnecté'}</p>
                                </div>
                                <div className="w-12 h-12 rounded-lg bg-yellow-500/20 flex items-center justify-center">
                                    <div className={`w-3 h-3 rounded-full ${stats.connected ? 'bg-green-500 animate-pulse' : 'bg-red-500'}`}></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div className="glass-effect p-6 rounded-xl card-hover">
                            <h3 className="text-lg font-semibold mb-4">Activité Récente</h3>
                            <div className="space-y-3">
                                {[
                                    { action: 'Connexion USB établie', time: 'Il y a 2 minutes', device: 'Arduino Uno' },
                                    { action: 'Upload du firmware', time: 'Il y a 10 minutes', device: 'ESP32' },
                                    { action: 'Données reçues', time: 'Il y a 15 minutes', device: 'USB Serial' },
                                    { action: 'Connexion WiFi établie', time: 'Il y a 30 minutes', device: 'ESP8266' }
                                ].map((item, index) => (
                                    <div key={index} className="flex items-center justify-between p-3 bg-gray-800/30 rounded-lg">
                                        <div>
                                            <p className="font-medium">{item.action}</p>
                                            <p className="text-sm text-gray-400">{item.device}</p>
                                        </div>
                                        <span className="text-sm text-gray-400">{item.time}</span>
                                    </div>
                                ))}
                            </div>
                        </div>
                        
                        <div className="glass-effect p-6 rounded-xl card-hover">
                            <h3 className="text-lg font-semibold mb-4">Appareils Connectés</h3>
                            <div className="space-y-4">
                                <div className="flex items-center justify-between p-4 bg-gray-800/30 rounded-lg">
                                    <div className="flex items-center space-x-3">
                                        <div className="w-10 h-10 rounded-lg bg-blue-500/20 flex items-center justify-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                                <circle cx="10" cy="7" r="1"></circle>
                                            </svg>
                                        </div>
                                        <div>
                                            <p className="font-medium">Arduino Uno</p>
                                            <p className="text-sm text-gray-400">COM3 • 115200 baud</p>
                                        </div>
                                    </div>
                                    <div className="flex items-center space-x-2">
                                        <div className="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                                        <span className="text-sm">Actif</span>
                                    </div>
                                </div>
                                
                                <div className="flex items-center justify-between p-4 bg-gray-800/30 rounded-lg">
                                    <div className="flex items-center space-x-3">
                                        <div className="w-10 h-10 rounded-lg bg-green-500/20 flex items-center justify-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                                <path d="M12 20h.01"></path>
                                            </svg>
                                        </div>
                                        <div>
                                            <p className="font-medium">ESP32</p>
                                            <p className="text-sm text-gray-400">192.168.1.100 • WiFi</p>
                                        </div>
                                    </div>
                                    <div className="flex items-center space-x-2">
                                        <div className="w-2 h-2 rounded-full bg-yellow-500"></div>
                                        <span className="text-sm">En attente</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        
        // USB Tab
        function USBTab() {
            const [connected, setConnected] = useState(false);
            const [baudRate, setBaudRate] = useState('115200');
            
            return (
                <div className="container mx-auto px-4 py-6">
                    <h2 className="text-2xl font-bold mb-6 gradient-text">Connexion USB</h2>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div className="glass-effect p-6 rounded-xl card-hover">
                            <div className="flex items-center space-x-3 mb-6">
                                <div className="w-12 h-12 rounded-lg bg-blue-500/20 flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                        <circle cx="10" cy="7" r="1"></circle>
                                        <circle cx="4" cy="20" r="1"></circle>
                                        <path d="M4.7 19.3 19 5"></path>
                                    </svg>
                                </div>
                                <div>
                                    <h3 className="text-xl font-semibold">Web Serial API</h3>
                                    <p className="text-gray-400">Connectez un Arduino via USB</p>
                                </div>
                            </div>
                            
                            <div className="space-y-4">
                                <div className="p-4 bg-gray-800/50 rounded-lg">
                                    <div className="flex items-center justify-between mb-4">
                                        <span className="text-gray-400">Statut</span>
                                        <div className="flex items-center space-x-2">
                                            <div className={`w-2 h-2 rounded-full ${connected ? 'bg-green-500 animate-pulse' : 'bg-gray-500'}`}></div>
                                            <span>{connected ? 'Connecté' : 'Déconnecté'}</span>
                                        </div>
                                    </div>
                                    
                                    <div className="flex items-center justify-between mb-6">
                                        <span className="text-gray-400">Vitesse (baud)</span>
                                        <select 
                                            value={baudRate}
                                            onChange={(e) => setBaudRate(e.target.value)}
                                            className="bg-gray-900 border border-gray-700 rounded-lg px-3 py-2"
                                        >
                                            <option value="9600">9600</option>
                                            <option value="115200">115200</option>
                                            <option value="57600">57600</option>
                                            <option value="38400">38400</option>
                                        </select>
                                    </div>
                                    
                                    <button 
                                        onClick={() => setConnected(!connected)}
                                        className={`btn-primary w-full ${connected ? 'bg-gradient-to-r from-red-500 to-red-700' : ''}`}
                                    >
                                        {connected ? 'Déconnecter' : 'Connecter le Port'}
                                    </button>
                                </div>
                                
                                <div className="grid grid-cols-2 gap-3">
                                    <button className="p-3 bg-gray-800/50 hover:bg-gray-800 rounded-lg text-center">
                                        Envoyer AT
                                    </button>
                                    <button className="p-3 bg-gray-800/50 hover:bg-gray-800 rounded-lg text-center">
                                        LED ON
                                    </button>
                                    <button className="p-3 bg-gray-800/50 hover:bg-gray-800 rounded-lg text-center">
                                        LED OFF
                                    </button>
                                    <button className="p-3 bg-gray-800/50 hover:bg-gray-800 rounded-lg text-center">
                                        Get Status
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div className="glass-effect p-6 rounded-xl card-hover">
                            <div className="flex items-center space-x-3 mb-6">
                                <div className="w-12 h-12 rounded-lg bg-purple-500/20 flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                                    </svg>
                                </div>
                                <div>
                                    <h3 className="text-xl font-semibold">Téléversement</h3>
                                    <p className="text-gray-400">Flash de firmware via USB</p>
                                </div>
                            </div>
                            
                            <div className="space-y-4">
                                <div className="p-4 bg-gray-800/50 rounded-lg">
                                    <div className="flex items-center space-x-2 mb-3">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                            <circle cx="12" cy="12" r="10"></circle>
                                            <line x1="12" x2="12" y1="8" y2="12"></line>
                                            <line x1="12" x2="12.01" y1="16" y2="16"></line>
                                        </svg>
                                        <p className="text-sm">Pour un téléversement fiable, utilisez Arduino IDE</p>
                                    </div>
                                    
                                    <div className="p-3 bg-gray-900/50 rounded font-mono text-sm space-y-1">
                                        <div className="text-green-400">arduino-cli compile --fqbn arduino:avr:uno .</div>
                                        <div className="text-blue-400">arduino-cli upload -p &lt;PORT&gt; --fqbn arduino:avr:uno .</div>
                                    </div>
                                    
                                    <button className="btn-primary w-full mt-4">
                                        Copier les Commandes
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        
        // WiFi Tab
        function WiFiTab() {
            const [connected, setConnected] = useState(false);
            const [ip, setIp] = useState('192.168.1.100');
            const [port, setPort] = useState('3232');
            
            return (
                <div className="container mx-auto px-4 py-6">
                    <h2 className="text-2xl font-bold mb-6 gradient-text">Connexion WiFi (OTA)</h2>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div className="glass-effect p-6 rounded-xl card-hover">
                            <div className="flex items-center space-x-3 mb-6">
                                <div className="w-12 h-12 rounded-lg bg-green-500/20 flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                        <path d="M12 20h.01"></path>
                                        <path d="M2 8.82a15 15 0 0 1 20 0"></path>
                                        <path d="M5 12.859a10 10 0 0 1 14 0"></path>
                                    </svg>
                                </div>
                                <div>
                                    <h3 className="text-xl font-semibold">ESP WiFi OTA</h3>
                                    <p className="text-gray-400">Programmation Over-The-Air</p>
                                </div>
                            </div>
                            
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium mb-2">Adresse IP</label>
                                    <input 
                                        type="text"
                                        value={ip}
                                        onChange={(e) => setIp(e.target.value)}
                                        className="w-full p-3 bg-gray-800/50 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500"
                                        placeholder="192.168.1.100"
                                    />
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium mb-2">Port</label>
                                    <input 
                                        type="number"
                                        value={port}
                                        onChange={(e) => setPort(e.target.value)}
                                        className="w-full p-3 bg-gray-800/50 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500"
                                    />
                                </div>
                                
                                <div className="p-4 bg-gray-800/50 rounded-lg">
                                    <div className="flex items-center justify-between">
                                        <span className="text-gray-400">Statut WiFi</span>
                                        <div className="flex items-center space-x-2">
                                            <div className={`w-2 h-2 rounded-full ${connected ? 'bg-green-500 animate-pulse' : 'bg-gray-500'}`}></div>
                                            <span>{connected ? 'Connecté' : 'Déconnecté'}</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <button 
                                    onClick={() => setConnected(!connected)}
                                    className={`btn-primary w-full ${connected ? 'bg-gradient-to-r from-red-500 to-red-700' : 'bg-gradient-to-r from-green-500 to-green-700'}`}
                                >
                                    {connected ? 'Déconnecter' : 'Se Connecter'}
                                </button>
                            </div>
                        </div>
                        
                        <div className="glass-effect p-6 rounded-xl card-hover">
                            <div className="flex items-center space-x-3 mb-6">
                                <div className="w-12 h-12 rounded-lg bg-yellow-500/20 flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="17 8 12 3 7 8"></polyline>
                                        <line x1="12" y1="3" x2="12" y2="15"></line>
                                    </svg>
                                </div>
                                <div>
                                    <h3 className="text-xl font-semibold">Upload Firmware</h3>
                                    <p className="text-gray-400">Téléversez un fichier .bin</p>
                                </div>
                            </div>
                            
                            <div className="space-y-4">
                                <div className="border-2 border-dashed border-gray-700 rounded-lg p-8 text-center hover:border-blue-500 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="mx-auto mb-4 text-gray-500">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                        <polyline points="17 8 12 3 7 8"></polyline>
                                        <line x1="12" y1="3" x2="12" y2="15"></line>
                                    </svg>
                                    <p className="text-gray-400 mb-2">Glissez-déposez un fichier .bin</p>
                                    <p className="text-sm text-gray-500">ou</p>
                                    <button className="mt-4 px-4 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg transition-colors">
                                        Parcourir les fichiers
                                    </button>
                                </div>
                                
                                <button className="btn-primary w-full">
                                    Uploader via OTA
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        
        // Code Editor Tab
        function CodeEditorTab() {
            const [code, setCode] = useState(`void setup() {
  Serial.begin(115200);
  pinMode(LED_BUILTIN, OUTPUT);
  Serial.println("Hello from Arduino!");
}

void loop() {
  digitalWrite(LED_BUILTIN, HIGH);
  delay(1000);
  digitalWrite(LED_BUILTIN, LOW);
  delay(1000);
  Serial.println("Blink!");
}`);
            
            return (
                <div className="container mx-auto px-4 py-6">
                    <h2 className="text-2xl font-bold mb-6 gradient-text">Éditeur de Code</h2>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div className="lg:col-span-2">
                            <div className="glass-effect p-6 rounded-xl card-hover h-full">
                                <div className="flex items-center justify-between mb-4">
                                    <h3 className="text-lg font-semibold">sketch.ino</h3>
                                    <div className="flex space-x-2">
                                        <button className="px-4 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg">
                                            Sauvegarder
                                        </button>
                                        <button className="btn-primary px-4 py-2">
                                            Compiler
                                        </button>
                                    </div>
                                </div>
                                
                                <textarea
                                    value={code}
                                    onChange={(e) => setCode(e.target.value)}
                                    className="w-full h-96 p-4 bg-gray-900 text-gray-100 font-mono rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    spellCheck="false"
                                />
                            </div>
                        </div>
                        
                        <div className="glass-effect p-6 rounded-xl card-hover">
                            <h3 className="text-lg font-semibold mb-4">Configuration</h3>
                            
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium mb-2">Carte</label>
                                    <select className="w-full p-3 bg-gray-800/50 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500">
                                        <option>Arduino Uno</option>
                                        <option>Arduino Nano</option>
                                        <option>Arduino Mega</option>
                                        <option>ESP32</option>
                                        <option>ESP8266</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium mb-2">Port</label>
                                    <select className="w-full p-3 bg-gray-800/50 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500">
                                        <option>COM3</option>
                                        <option>COM4</option>
                                        <option>/dev/ttyUSB0</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium mb-2">Vitesse (baud)</label>
                                    <select className="w-full p-3 bg-gray-800/50 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500">
                                        <option>9600</option>
                                        <option selected>115200</option>
                                        <option>57600</option>
                                        <option>38400</option>
                                    </select>
                                </div>
                                
                                <div className="pt-4 border-t border-gray-800">
                                    <h4 className="font-medium mb-2">Résultat</h4>
                                    <div className="p-3 bg-gray-900/50 rounded font-mono text-sm">
                                        <div className="text-green-400">Compilation réussie!</div>
                                        <div className="text-gray-400">Sketch uses 1456 bytes (4%)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        
        // 3D Visual Tab
        function ThreeVisualTab() {
            const canvasRef = useRef(null);
            const [rotation, setRotation] = useState(true);
            
            useEffect(() => {
                if (!canvasRef.current) return;
                
                // Initialiser Three.js
                const scene = new THREE.Scene();
                scene.background = new THREE.Color(0x0f172a);
                
                const camera = new THREE.PerspectiveCamera(75, canvasRef.current.clientWidth / 400, 0.1, 1000);
                camera.position.z = 10;
                
                const renderer = new THREE.WebGLRenderer({ antialias: true });
                renderer.setSize(canvasRef.current.clientWidth, 400);
                canvasRef.current.appendChild(renderer.domElement);
                
                // Lumière
                const light = new THREE.DirectionalLight(0xffffff, 1);
                light.position.set(5, 5, 5);
                scene.add(light);
                
                const ambientLight = new THREE.AmbientLight(0x404040);
                scene.add(ambientLight);
                
                // Créer une sphère principale
                const geometry = new THREE.SphereGeometry(3, 32, 32);
                const material = new THREE.MeshPhongMaterial({
                    color: 0x3b82f6,
                    wireframe: true,
                    transparent: true,
                    opacity: 0.7
                });
                const sphere = new THREE.Mesh(geometry, material);
                scene.add(sphere);
                
                // Ajouter des particules
                const particles = new THREE.Group();
                for (let i = 0; i < 100; i++) {
                    const particleGeometry = new THREE.SphereGeometry(0.1, 8, 8);
                    const particleMaterial = new THREE.MeshBasicMaterial({
                        color: Math.random() > 0.5 ? 0x60a5fa : 0xa78bfa
                    });
                    const particle = new THREE.Mesh(particleGeometry, particleMaterial);
                    
                    // Position aléatoire autour de la sphère
                    const radius = 3.5;
                    const theta = Math.random() * Math.PI * 2;
                    const phi = Math.acos(2 * Math.random() - 1);
                    
                    particle.position.x = radius * Math.sin(phi) * Math.cos(theta);
                    particle.position.y = radius * Math.sin(phi) * Math.sin(theta);
                    particle.position.z = radius * Math.cos(phi);
                    
                    particle.userData = { speed: Math.random() * 0.02 + 0.01 };
                    particles.add(particle);
                }
                scene.add(particles);
                
                // Animation
                let animationId;
                const animate = () => {
                    animationId = requestAnimationFrame(animate);
                    
                    if (rotation) {
                        sphere.rotation.y += 0.01;
                        sphere.rotation.x += 0.005;
                        
                        particles.children.forEach(particle => {
                            particle.rotation.x += particle.userData.speed;
                            particle.rotation.y += particle.userData.speed;
                        });
                    }
                    
                    renderer.render(scene, camera);
                };
                animate();
                
                // Redimensionnement
                const handleResize = () => {
                    camera.aspect = canvasRef.current.clientWidth / 400;
                    camera.updateProjectionMatrix();
                    renderer.setSize(canvasRef.current.clientWidth, 400);
                };
                window.addEventListener('resize', handleResize);
                
                // Nettoyage
                return () => {
                    window.removeEventListener('resize', handleResize);
                    cancelAnimationFrame(animationId);
                    if (canvasRef.current) {
                        canvasRef.current.removeChild(renderer.domElement);
                    }
                };
            }, [rotation]);
            
            return (
                <div className="container mx-auto px-4 py-6">
                    <h2 className="text-2xl font-bold mb-6 gradient-text">Visualisation 3D</h2>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div className="lg:col-span-2">
                            <div className="glass-effect rounded-xl card-hover overflow-hidden">
                                <div 
                                    ref={canvasRef}
                                    className="three-canvas"
                                />
                                <div className="p-4 bg-gray-900/50 flex justify-between items-center">
                                    <div className="text-sm text-gray-400">
                                        Visualisation des données en temps réel
                                    </div>
                                    <div className="flex space-x-2">
                                        <button 
                                            onClick={() => setRotation(!rotation)}
                                            className={`px-3 py-1 rounded text-sm ${rotation ? 'bg-blue-500' : 'bg-gray-700'}`}
                                        >
                                            {rotation ? 'Pause' : 'Rotation'}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div className="glass-effect p-6 rounded-xl card-hover">
                            <h3 className="text-lg font-semibold mb-4">Contrôles 3D</h3>
                            
                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium mb-2">Mode</label>
                                    <select className="w-full p-3 bg-gray-800/50 border border-gray-700 rounded-lg">
                                        <option>Sphère Interactive</option>
                                        <option>Points de Données</option>
                                        <option>Réseau 3D</option>
                                        <option>Graphique en Temps Réel</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium mb-2">Couleur</label>
                                    <select className="w-full p-3 bg-gray-800/50 border border-gray-700 rounded-lg">
                                        <option>Bleu (Défaut)</option>
                                        <option>Arc-en-ciel</option>
                                        <option>Vert</option>
                                        <option>Violet</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium mb-2">Vitesse</label>
                                    <input 
                                        type="range" 
                                        min="0" 
                                        max="100" 
                                        defaultValue="50"
                                        className="w-full"
                                    />
                                </div>
                                
                                <div className="pt-4 border-t border-gray-800">
                                    <h4 className="font-medium mb-2">Info</h4>
                                    <div className="text-sm text-gray-400 space-y-1">
                                        <p>• 100 particules actives</p>
                                        <p>• Rotation: {rotation ? 'Activée' : 'Désactivée'}</p>
                                        <p>• Three.js r128</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        
        // Serial Monitor Tab
        function SerialMonitorTab() {
            const [lines, setLines] = useState([
                { type: 'info', text: '// Moniteur série prêt...' },
                { type: 'info', text: '// Connectez-vous via USB ou WiFi' }
            ]);
            const [input, setInput] = useState('');
            const [autoScroll, setAutoScroll] = useState(true);
            
            const sendCommand = () => {
                if (!input.trim()) return;
                
                // Ajouter la commande
                const newLines = [...lines, { type: 'command', text: `>> ${input}` }];
                setLines(newLines);
                
                // Simuler une réponse après 500ms
                setTimeout(() => {
                    const responses = [
                        'OK',
                        'ERROR: Command not recognized',
                        'LED ON',
                        'LED OFF',
                        'Temperature: 23.5°C',
                        'Humidity: 45%',
                        'Voltage: 3.3V'
                    ];
                    const response = responses[Math.floor(Math.random() * responses.length)];
                    setLines(prev => [...prev, { type: 'response', text: response }]);
                }, 500);
                
                setInput('');
            };
            
            const clearMonitor = () => {
                setLines([{ type: 'info', text: '// Moniteur effacé' }]);
            };
            
            return (
                <div className="container mx-auto px-4 py-6">
                    <h2 className="text-2xl font-bold mb-6 gradient-text">Moniteur Série</h2>
                    
                    <div className="glass-effect p-6 rounded-xl card-hover">
                        <div className="flex flex-wrap items-center justify-between gap-4 mb-6">
                            <div className="flex items-center space-x-4">
                                <div className="flex items-center space-x-2">
                                    <div className="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                                    <span className="text-sm">Connecté</span>
                                </div>
                                <div className="text-sm text-gray-400">
                                    115200 baud • {lines.length} lignes
                                </div>
                            </div>
                            
                            <div className="flex space-x-2">
                                <button 
                                    onClick={clearMonitor}
                                    className="px-4 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg"
                                >
                                    Effacer
                                </button>
                                <button 
                                    onClick={() => setAutoScroll(!autoScroll)}
                                    className={`px-4 py-2 rounded-lg ${autoScroll ? 'bg-blue-500' : 'bg-gray-800'}`}
                                >
                                    Auto-scroll: {autoScroll ? 'ON' : 'OFF'}
                                </button>
                            </div>
                        </div>
                        
                        <div className="terminal">
                            <div className="terminal-content">
                                {lines.map((line, index) => (
                                    <div 
                                        key={index} 
                                        className={`mb-1 ${line.type === 'command' ? 'command' : line.type === 'response' ? 'response' : 'text-gray-400'}`}
                                    >
                                        {line.text}
                                    </div>
                                ))}
                            </div>
                            
                            <div className="p-4 border-t border-gray-800 flex space-x-2">
                                <input
                                    type="text"
                                    value={input}
                                    onChange={(e) => setInput(e.target.value)}
                                    onKeyPress={(e) => e.key === 'Enter' && sendCommand()}
                                    placeholder="Entrez une commande..."
                                    className="flex-1 p-3 bg-gray-900 border border-gray-700 rounded-lg focus:outline-none focus:border-blue-500"
                                />
                                <button 
                                    onClick={sendCommand}
                                    className="btn-primary px-6"
                                >
                                    Envoyer
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }
        
        // Main App Component
        function App() {
            const [activeTab, setActiveTab] = useState('dashboard');
            
            // Initialiser les icônes Lucide
            useEffect(() => {
                lucide.createIcons();
            }, []);
            
            // Rendu conditionnel
            const renderTab = () => {
                switch(activeTab) {
                    case 'dashboard':
                        return <Dashboard />;
                    case 'usb':
                        return <USBTab />;
                    case 'wifi':
                        return <WiFiTab />;
                    case 'editor':
                        return <CodeEditorTab />;
                    case 'visual':
                        return <ThreeVisualTab />;
                    case 'monitor':
                        return <SerialMonitorTab />;
                    default:
                        return <Dashboard />;
                }
            };
            
            return (
                <div className="min-h-screen bg-gray-900">
                    <Header />
                    <Navigation activeTab={activeTab} setActiveTab={setActiveTab} />
                    {renderTab()}
                    
                    <footer className="mt-16 py-6 border-t border-gray-800">
                        <div className="container mx-auto px-4 text-center text-gray-400 text-sm">
                            <p>Arduino 3D Programmer • React + Three.js • v2.0</p>
                            <p className="mt-2">Web Serial API & OTA WiFi Interface</p>
                        </div>
                    </footer>
                </div>
            );
        }
        
        // Rendu de l'application
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>